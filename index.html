<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Last Call Dispatch Operator</title>

  <!-- ForÃ§ar nÃ£o-cache (ajuda, mas o principal Ã© o ?v nos scripts) -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <link rel="stylesheet" href="./styles.css?v=2025-12-26-01" />
</head>

<body>
  <div class="app">
    <header class="topbar">
      <div class="brand">
        <div class="logo"></div>
        <div class="brandText">
          <div class="title">Last Call Dispatch Operator</div>
          <div class="subtitle">Simulador de Central de EmergÃªncia</div>
        </div>
      </div>

      <div class="hud">
        <div class="hudItem">
          <div class="hudLabel">Turno</div>
          <div class="hudValue" id="hudShift">â€”</div>
        </div>
        <div class="hudItem">
          <div class="hudLabel">Tempo</div>
          <div class="hudValue" id="hudTime">00:00</div>
        </div>
        <div class="hudItem">
          <div class="hudLabel">Pontos</div>
          <div class="hudValue" id="hudScore">0</div>
        </div>
        <div class="hudItem">
          <div class="hudLabel">Chamadas</div>
          <div class="hudValue" id="hudQueue">0</div>
        </div>

        <div class="hudItem">
          <div class="hudLabel">Stress</div>
          <div class="hudValue hudMeter" id="hudStress" style="--meter:0%">0%</div>
        </div>
      </div>
    </header>

    <main>
      <!-- SCREEN 1: Setup (cidade/agÃªncia/dificuldade) -->
      <div class="screen grid active" id="screenSetup">
        <section class="card">
          <div class="cardTitle">ConfiguraÃ§Ã£o</div>

        <div class="formRow">
          <label class="label">Cidade</label>
          <select id="citySelect" class="select"></select>
        </div>

        <div class="formRow">
          <label class="label">AgÃªncia</label>
          <select id="agencySelect" class="select">
            <option value="police">PolÃ­cia</option>
            <option value="fire">Bombeiros</option>
          </select>
        </div>

        <div class="formRow">
          <label class="label">Dificuldade</label>
          <select id="difficultySelect" class="select">
            <option value="easy">FÃ¡cil</option>
            <option value="normal" selected>Normal</option>
            <option value="hard">DifÃ­cil</option>
          </select>
        </div>

          <div class="btnRow">
            <button id="btnToLobby" class="btnPrimary">Continuar</button>
          </div>

        <div class="hint">
          Regra do jogo: vocÃª <b>atende</b> e depois faz <b>despacho manual</b>. Se for trote, o correto Ã© <b>encerrar</b>.
        </div>
        </section>
      </div>

      <!-- SCREEN 2: Lobby (confirmaÃ§Ã£o + unidades) -->
      <div class="screen grid" id="screenLobby">
        <section class="card">
          <div class="cardTitle">Lobby</div>
          <div class="hint" id="lobbySummary">â€”</div>

          <div class="subCard" style="margin-top:12px;">
            <div class="subTitle">ğŸ–ï¸ Carreira</div>
            <div class="pills" id="lobbyCareerPills"></div>
            <div class="hint" id="lobbyUnlocksHint" style="margin-top:8px;">â€”</div>
            <div class="btnRow" style="margin-top:10px;">
              <button id="btnResetCareer" class="btnGhost">Resetar carreira</button>
            </div>
          </div>

          <div class="subCard" style="margin-top:12px;">
            <div class="subTitle">ğŸ’¼ Semana (Campanha)</div>
            <div class="pills" id="lobbyCampaignPills"></div>
            <div class="hint" id="lobbyCampaignHint" style="margin-top:8px;">â€”</div>
            <div class="btnRow" style="margin-top:10px;">
              <button id="btnResetWeek" class="btnGhost">Resetar semana</button>
            </div>
          </div>

          <div class="subCard" style="margin-top:12px;">
            <div class="subTitle">ğŸ’° OperaÃ§Ã£o</div>
            <div class="pills" id="lobbyEconomyPills"></div>
            <div class="hint" id="lobbyEconomyHint" style="margin-top:8px;">â€”</div>
          </div>

          <div class="subCard" style="margin-top:12px;">
            <div class="subTitle">ğŸ§© Upgrades</div>
            <div id="lobbyUpgrades" class="upgradeGrid">â€”</div>
            <div class="hint" id="lobbyUpgradesHint" style="margin-top:8px;">Compre melhorias com o orÃ§amento para reduzir stress, ganhar tempo e aumentar eficiÃªncia.</div>
          </div>

          <div class="subCard" style="margin-top:12px;">
            <div class="subTitle">ğŸ¯ Objetivos do turno</div>
            <div id="lobbyObjectives" class="summary">â€”</div>
          </div>
          <div class="btnRow" style="margin-top:12px;">
            <button id="btnBackSetup" class="btnGhost">Voltar</button>
            <button id="btnToShift" class="btnPrimary">Ir para o plantÃ£o</button>
          </div>
          <div class="hint" style="margin-top:10px;">Revise as unidades disponÃ­veis antes de iniciar o turno.</div>
        </section>

        <section class="card">
          <div class="cardTitle">Unidades</div>
          <div id="unitsList" class="list"></div>
          <div class="hint">Dica: cada unidade tem funÃ§Ã£o (role). Enviar errado dÃ¡ penalidade.</div>
        </section>
      </div>

      <!-- SCREEN 3: PlantÃ£o (jogo) -->
      <div class="screen grid" id="screenShift">
        <section class="card">
          <div class="cardTitle">Controles do Turno</div>
          <div class="hint" id="shiftSummaryTop">â€”</div>
          <div class="btnRow" style="margin-top:12px;">
            <button id="btnBackLobby" class="btnGhost">Lobby</button>
            <button id="btnStartShift" class="btnPrimary">Iniciar Turno</button>
            <button id="btnEndShift" class="btnGhost" disabled>Encerrar Turno</button>
          </div>
        </section>

        <section class="card">
          <div class="cardTitle">OperaÃ§Ã£o</div>

        <div class="pills">
          <div class="pill" id="pillStatus">Turno parado</div>
          <div class="pill pillWarn" id="pillCallTimer">Sem chamada</div>
        </div>

        <div class="subCard">
          <div class="subTitle">ğŸ“ Chamada Atual</div>
          <div class="meta" id="callMeta">â€”</div>
          <div class="callBox" id="callText">Inicie um turno para receber chamadas.</div>

          <div class="btnRow">
            <button id="btnAnswer" class="btnPrimary" disabled>Atender prÃ³xima</button>
            <button id="btnHold" class="btnGhost" disabled>Colocar em espera</button>
          </div>
        </div>

        <div class="subCard">
          <div class="subTitle">ğŸš“ Despacho Manual</div>
          <div class="meta" id="dispatchInfo">â€”</div>

          <label class="label" style="margin-top:8px;">Escolha a unidade</label>
          <select id="dispatchUnitSelect" class="select" disabled></select>

          <div class="btnRow">
            <button id="btnDispatch" class="btnPrimary" disabled>Despachar</button>
            <button id="btnDismiss" class="btnGhost" disabled>Encerrar chamada</button>
          </div>

          <div class="hint">VocÃª pontua por escolher a unidade certa (ou encerrar trote) dentro do tempo.</div>
        </div>
        </section>

        <section class="card">
          <div class="cardTitle">Fila de Chamadas</div>
          <div id="queueList" class="queue">â€”</div>
        </section>

        <section class="card">
          <div class="cardTitle">Registro</div>
          <pre id="log" class="log"></pre>
        </section>

        <section class="card">
          <div class="cardTitle">Resumo do Turno</div>
          <div id="shiftSummary" class="summary">Nenhum turno ativo.</div>
        </section>
      </div>
    </main>
  </div>

  <!-- MUITO IMPORTANTE: ordem e cache-busting -->
  <script src="./data/cities.js?v=2025-12-26-01"></script>
  <script src="./data/calls.js?v=2025-12-26-01"></script>
  <script src="./script.js?v=2025-12-26-01"></script>
</body>
</html>